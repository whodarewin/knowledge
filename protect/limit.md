# 限流
常用限流方式分为三种，计数器，令牌桶，漏斗算法。
## 计数器
### 实现
最简单的算法，即在一定时间窗口内，分配多少个流量，当这个时间窗口内流量用完，剩余时间拒绝所有请求。
### 优缺点
优点是实现简单，缺点是会有突增流量问题，比如在一个时间窗口开始时，大流量将时间窗口内的流量份额在短时间全部用完，剩余时间请求就全部拒绝。
## 令牌桶
### 实现
想象有一个令牌桶，有两个动作规定了向令牌桶中放令牌的规则和从令牌桶中拿令牌的规则。
1. 放令牌，按照一定时间间隔向桶中放令牌，当桶中令牌数量超过桶自身容量，则丢弃令牌，不再放入。
2. 取令牌，需要令牌便从桶中拿令牌，没有时间限制。
### 优缺点
可以看到，由于取令牌没有时间限制，这个算法，允许突增流量，但突增流量可以被令牌桶最大容量限制。
## 漏斗算法
### 实现
想象有一个漏斗，进入漏斗的流量是不限制的，除非漏斗内已经全部放满，溢出了就拒绝了。  
但是从漏斗中流出的流量是固定的，只能以固定速率流出，这便是漏斗算法。
### 优缺点
不允许突增流量，流量很平滑的流出，但问题是会对速度产生限制，因为流入漏斗到流出漏斗会有排队的情况出现。 
